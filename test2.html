<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>E-commerce Store</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <!-- Nice Select CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/jquery-nice-select@1.1.0/css/nice-select.css"
    />
    <style>
      .brand-logo.selected {
        border: 2px solid #8b5cf6 !important;
        position: relative;
      }
      .brand-logo.selected::after {
        content: "✓";
        position: absolute;
        width: 60px;
        height: 60px;
        top: 0px;
        right: 0px;
        font-size: 14px;
        font-weight: bold;
        color: #8b5cf6;
        background: yellow;
      }
      /* Range slider overlap fix */
      .range-slider {
        position: relative;
        width: 100%;
        height: 6px;
      }
      .range-slider input[type="range"] {
        -webkit-appearance: none;
        width: 100%;
        height: 6px;
        background: transparent;
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        pointer-events: none;
        z-index: 3;
      }
      .range-slider input[type="range"]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #8b5cf6; /* purple */
        cursor: pointer;
        pointer-events: all;
        position: relative;
        z-index: 5;
      }
      .range-slider input[type="range"]::-moz-range-thumb {
        width: 18px;
        height: 18px;
        border-radius: 50%;
        background: #8b5cf6;
        cursor: pointer;
        pointer-events: all;
        position: relative;
        z-index: 5;
      }
      .slider-track {
        position: absolute;
        height: 6px;
        background: #8b5cf6;
        border-radius: 9999px;
        top: 50%;
        transform: translateY(-50%);
        z-index: 2;
      }
      .slider-bg {
        position: absolute;
        height: 6px;
        background: #d1d5db; /* gray-300 */
        border-radius: 9999px;
        top: 50%;
        transform: translateY(-50%);
        width: 100%;
        z-index: 1;
      }

      /* Smooth mobile toggle */
      #filterMenu {
        transition: max-height 0.3s ease, opacity 0.3s ease, padding 0.3s ease;
        overflow: hidden;
      }
      #filterMenu.closed {
        max-height: 0;
        opacity: 0;
        padding-top: 0;
        padding-bottom: 0;
      }
      #filterMenu.open {
        max-height: 100vh; /* large enough for content */
        opacity: 1;
      }
    </style>
  </head>
  <body class="bg-gray-100 font-sans">
    <header class="bg-purple-700 text-white p-4 md:p-6 text-center">
      <h1 class="text-xl md:text-3xl font-bold">Get 10% Cashback</h1>
      <p class="text-md md:text-lg mt-2">on Shopping €150</p>
    </header>

    <div class="container mx-auto px-4 py-6 flex flex-col md:flex-row gap-6">
      <!-- Sidebar Filter -->
      <aside class="w-full md:w-1/4 bg-white p-4 rounded-lg shadow-md">
        <div class="flex justify-between items-center">
          <h2 class="text-lg font-semibold text-gray-800">Filter</h2>
          <button
            id="filterToggle"
            class="md:hidden p-2 text-gray-500 hover:text-gray-700"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16m-7 6h7"
              ></path>
            </svg>
          </button>
        </div>

        <div id="filterMenu" class="md:block">
          <!-- Search Input -->
          <div class="mb-6">
            <input
              type="text"
              placeholder="Search products..."
              class="w-full p-2 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"
            />
          </div>

          <!-- Category Radio -->
          <div class="mb-6">
            <h3 class="text-md font-medium text-gray-700 mb-2">Category</h3>
            <label class="flex items-center mb-2 text-sm text-gray-700">
              <input
                type="radio"
                name="category"
                class="form-radio text-purple-600 mr-2"
              />
              Fruits & Vegetables (128)
            </label>
            <label class="flex items-center mb-2 text-sm text-gray-700">
              <input
                type="radio"
                name="category"
                class="form-radio text-purple-600 mr-2"
              />
              Dairy & Breakfast (90)
            </label>
            <label class="flex items-center mb-2 text-sm text-gray-700">
              <input
                type="radio"
                name="category"
                class="form-radio text-purple-600 mr-2"
              />
              Snacks (56)
            </label>
          </div>

          <!-- Brand -->
          <div class="mb-6">
            <h3 class="text-md font-medium text-gray-700 mb-2">Brand</h3>
            <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-2 gap-2">
              <img
                src="https://via.placeholder.com/60x30?text=Brand1"
                alt="Brand1"
                class="brand-logo border border-gray-300 rounded p-1 cursor-pointer"
              />
              <img
                src="https://via.placeholder.com/60x30?text=Brand2"
                alt="Brand2"
                class="brand-logo border border-gray-300 rounded p-1 cursor-pointer"
              />
              <img
                src="https://via.placeholder.com/60x30?text=Brand3"
                alt="Brand3"
                class="brand-logo border border-gray-300 rounded p-1 cursor-pointer"
              />
            </div>
          </div>

          <!-- Dual Range Slider -->
          <div class="mb-6">
            <h3 class="text-md font-medium text-gray-700 mb-4">Price Range</h3>
            <div class="range-slider">
              <div class="slider-bg"></div>
              <div id="sliderTrack" class="slider-track"></div>
              <input
                type="range"
                id="minRange"
                min="0"
                max="500"
                value="100"
                step="10"
              />
              <input
                type="range"
                id="maxRange"
                min="0"
                max="500"
                value="400"
                step="10"
              />
            </div>
            <div class="flex justify-between text-sm text-gray-600 mt-6">
              <span id="minValue">€100</span>
              <span id="maxValue">€400</span>
            </div>
          </div>

          <button
            class="bg-purple-600 text-white w-full py-2 rounded-md hover:bg-purple-700 transition"
          >
            Apply
          </button>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="w-full md:w-3/4">
        <div
          class="flex justify-between items-center bg-white p-4 rounded-lg shadow-md mb-6"
        >
          <h2 class="text-lg font-semibold text-gray-800">All Products</h2>
          <select id="sort-by" class="border-gray-300">
            <option>Sort By</option>
            <option>Price: Low to High</option>
            <option>Price: High to Low</option>
            <option>Newest</option>
          </select>
        </div>

        <div
          class="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"
        >
          <div class="bg-white p-4 rounded-lg shadow-md text-center">
            <img
              src="https://via.placeholder.com/150"
              class="w-full h-32 object-contain mb-2"
            />
            <h3 class="font-medium text-gray-800">Product Name</h3>
            <p class="text-sm text-gray-500">Description</p>
            <p class="text-purple-600 font-bold mt-2">€19.99</p>
            <button
              class="bg-purple-600 text-white px-4 py-2 rounded-md mt-2 hover:bg-purple-700"
            >
              Add to Cart
            </button>
          </div>
        </div>
      </main>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Nice Select JS -->
    <script src="https://cdn.jsdelivr.net/npm/jquery-nice-select@1.1.0/js/jquery.nice-select.min.js"></script>
    <script>
      $(document).ready(function () {
        // Initialize nice select
        $("#sort-by").niceSelect();

        const niceSelect = $("#sort-by").next(".nice-select");

        niceSelect.on("click", function () {
          const dropdown = $(this).find(".list");
          const wrapper = $(this);

          dropdown.css({ visibility: "hidden", display: "block" });

          const rect = dropdown[0].getBoundingClientRect();
          const wrapperRect = wrapper[0].getBoundingClientRect();
          const viewportWidth = window.innerWidth;
          const viewportHeight = window.innerHeight;

          dropdown.css({
            left: "auto",
            right: "auto",
            top: "auto",
            bottom: "auto",
          });

          if (wrapperRect.left + dropdown.outerWidth() > viewportWidth) {
            dropdown.css({ right: "0px", left: "auto" });
          } else {
            dropdown.css({ left: "0px", right: "auto" });
          }

          if (wrapperRect.bottom + dropdown.outerHeight() > viewportHeight) {
            dropdown.css({ bottom: "100%", top: "auto" });
          } else {
            dropdown.css({ top: "100%", bottom: "auto" });
          }

          dropdown.css({ visibility: "", display: "" });
        });

        // Brand select toggle
        $(".brand-logo").on("click", function () {
          $(this).toggleClass("selected");
        });

        // Dual range slider
        const minRange = document.getElementById("minRange");
        const maxRange = document.getElementById("maxRange");
        const minValue = document.getElementById("minValue");
        const maxValue = document.getElementById("maxValue");
        const sliderTrack = document.getElementById("sliderTrack");
        const max = parseInt(maxRange.max);

        function fillTrack() {
          let minPercent = (minRange.value / max) * 100;
          let maxPercent = (maxRange.value / max) * 100;
          sliderTrack.style.left = minPercent + "%";
          sliderTrack.style.width = maxPercent - minPercent + "%";
        }

        minRange.addEventListener("input", function () {
          if (parseInt(minRange.value) >= parseInt(maxRange.value)) {
            minRange.value = maxRange.value - 10;
          }
          minValue.innerText = "€" + minRange.value;
          fillTrack();
        });

        maxRange.addEventListener("input", function () {
          if (parseInt(maxRange.value) <= parseInt(minRange.value)) {
            maxRange.value = parseInt(minRange.value) + 10;
          }
          maxValue.innerText = "€" + maxRange.value;
          fillTrack();
        });

        fillTrack();

        // Mobile filter toggle
        const filterToggle = $("#filterToggle");
        const filterMenu = $("#filterMenu");

        if ($(window).width() < 768) {
          filterMenu.addClass("closed");
        }

        filterToggle.on("click", function () {
          if (filterMenu.hasClass("closed")) {
            filterMenu.removeClass("closed").addClass("open");
          } else {
            filterMenu.removeClass("open").addClass("closed");
          }
        });

        $(window).on("resize", function () {
          if ($(window).width() >= 768) {
            filterMenu.removeClass("closed open").show();
          } else if (
            !filterMenu.hasClass("closed") &&
            !filterMenu.hasClass("open")
          ) {
            filterMenu.addClass("closed");
          }
        });
      });
    </script>
  </body>
</html>
